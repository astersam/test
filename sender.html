<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sender Bridge</title>
</head>
<body>
    <!-- This page is a transactional bridge. It performs one action and closes. -->
    <script>
        // Helper function to set a cookie.
        function setCookie(name, value, days = 1) {
            const encodedValue = encodeURIComponent(value);
            const date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            const expires = "expires=" + date.toUTCString();
            document.cookie = `${name}=${encodedValue}; ${expires}; SameSite=None; Secure; Path=/`;
        }

        (function() {
            const urlParams = new URLSearchParams(window.location.search);
            const cookieName = urlParams.get('name');
            const cookieValue = urlParams.get('value'); // This should be a pre-encoded JSON string

            if (cookieName && cookieValue) {
                try {
                    // Set the cookie with the provided name and value
                    setCookie(cookieName, cookieValue);
                } catch (e) {
                    console.error("Bridge Sender Error:", e);
                } finally {
                    setTimeout(() => {
                        window.close();
                    }, 50);
                }
            } else {
                window.close();
            }
        })();
    </script>
</body>
</html>

